<!--
  Copyright (c) Microsoft Corporation.
  Licensed under the MIT License.
-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!--
    Workaround issues in MSBuild versions previous to 16.0.
  -->
  <PropertyGroup>
    <MSBuildAllProjects Condition=" '$(MSBuildVersion)' == '' Or '$(MSBuildVersion)' &lt; '16.0' ">$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
  </PropertyGroup>

  <!--
    Decide whether we're compiling a quantum library or a quantum executable depending
    on the value of the OutputType common MSBuild property.
  -->
  <Choose>
    <When Condition="'$(OutputType)' == 'Library' Or '$(OutputType)' == ''">
      <PropertyGroup>
        <ResolvedQsharpOutputType>QsharpLibrary</ResolvedQsharpOutputType>
      </PropertyGroup>
    </When>
    <When Condition="'$(OutputType)' == 'Exe'">
      <PropertyGroup>
        <ResolvedQsharpOutputType>QsharpExe</ResolvedQsharpOutputType>
      </PropertyGroup>
    </When>
    <Otherwise>
      <PropertyGroup>
        <ResolvedQsharpOutputType></ResolvedQsharpOutputType>
      </PropertyGroup>
    </Otherwise>
  </Choose> 

  <Target Name="InvalidOutputTypeTarget" BeforeTargets="CoreCompile">
    <Error Condition = "'$(ResolvedQsharpOutputType)' == ''" Text="Invalid OutputType '$(OutputType)' for quantum project. Only 'Exe' and 'Library' are supported for quantum compilation." />
  </Target>


  <Import Project="$(MSBuildThisFileDirectory)..\DefaultItems\DefaultPackages.targets"/>
  <Import Project="$(MSBuildThisFileDirectory)..\DefaultItems\DefaultContent.targets"/>
  <Import Project="Sdk.targets" Sdk="Microsoft.NET.Sdk"/>

</Project>
